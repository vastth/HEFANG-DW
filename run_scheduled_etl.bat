@echo off
REM ========================================================================
REM 何方珠宝 - ETL自动化执行脚本（Windows）
REM 用于Windows任务计划程序调度
REM ========================================================================

chcp 65001 >nul
cd /d %~dp0

echo ========================================================================
echo   何方珠宝数仓ETL - 自动化执行
echo   开始时间: %date% %time%
echo ========================================================================

REM 激活Python环境（如果使用虚拟环境）
REM call venv\Scripts\activate.bat

REM 执行ETL
python scheduled_etl.py

REM 检查执行结果
if %ERRORLEVEL% EQU 0 (
    echo.
    echo ✓ ETL执行成功
    echo ========================================================================
    exit /b 0
) else (
    echo.
    echo ✗ ETL执行失败，错误码: %ERRORLEVEL%
    echo ========================================================================
    exit /b %ERRORLEVEL%
)
